<!DOCTYPE html>
<html lang="cn">
<head>
  
    <title>Elasticsearch terminology: Index &amp; Shard &amp; Segment :: 重案组之虎</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="References from https://stackoverflow.com/a/15429578
To explain:
Index An &amp;ldquo;index&amp;rdquo; in Elasticsearch is a bit like a database in a relational DB. It&amp;rsquo;s where you store/index your data. But actually, that&amp;rsquo;s just what your application sees. Internally, an index is a logical namespace that points to one or more shards.
Also, &amp;ldquo;to index&amp;rdquo; means to &amp;ldquo;put&amp;rdquo; your data into Elasticsearch. Your data is both stored (for retrieval) and &amp;ldquo;indexed&amp;rdquo; for search.
Inverted Index An &amp;ldquo;inverted index&amp;rdquo; is the data structure that Lucene uses to make data searchable."/>
<meta name="keywords" content="Elasticsearch"/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="/posts/es-terminology/" />


<link rel="stylesheet" href="/assets/style.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">

<link rel="shortcut icon" href="/avator.jpeg">



<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Elasticsearch terminology: Index &amp; Shard &amp; Segment :: 重案组之虎 — " />
<meta name="twitter:description" content="References from https://stackoverflow.com/a/15429578
To explain:
Index An &amp;ldquo;index&amp;rdquo; in Elasticsearch is a bit like a database in a relational DB. It&amp;rsquo;s where you store/index your data. But actually, that&amp;rsquo;s just what your application sees. Internally, an index is a logical namespace that points to one or more shards.
Also, &amp;ldquo;to index&amp;rdquo; means to &amp;ldquo;put&amp;rdquo; your data into Elasticsearch. Your data is both stored (for retrieval) and &amp;ldquo;indexed&amp;rdquo; for search.
Inverted Index An &amp;ldquo;inverted index&amp;rdquo; is the data structure that Lucene uses to make data searchable." />
<meta name="twitter:site" content="/" />
<meta name="twitter:creator" content="x1ah" />
<meta name="twitter:image" content="">


<meta property="og:locale" content="cn" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Elasticsearch terminology: Index &amp; Shard &amp; Segment :: 重案组之虎 — ">
<meta property="og:description" content="References from https://stackoverflow.com/a/15429578
To explain:
Index An &amp;ldquo;index&amp;rdquo; in Elasticsearch is a bit like a database in a relational DB. It&amp;rsquo;s where you store/index your data. But actually, that&amp;rsquo;s just what your application sees. Internally, an index is a logical namespace that points to one or more shards.
Also, &amp;ldquo;to index&amp;rdquo; means to &amp;ldquo;put&amp;rdquo; your data into Elasticsearch. Your data is both stored (for retrieval) and &amp;ldquo;indexed&amp;rdquo; for search.
Inverted Index An &amp;ldquo;inverted index&amp;rdquo; is the data structure that Lucene uses to make data searchable." />
<meta property="og:url" content="/posts/es-terminology/" />
<meta property="og:site_name" content="Elasticsearch terminology: Index &amp; Shard &amp; Segment" />
<meta property="og:image" content="">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2020-11-04 00:00:00 &#43;0000 UTC" />











</head>
<body class="">


<div class="container center">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    重案组之虎罢了
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about/">About</a></li>
        
      
        
          <li><a href="/index.xml">RSS</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about/">About</a></li>
      
    
      
        <li><a href="/index.xml">RSS</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="/posts/es-terminology/">Elasticsearch terminology: Index &amp; Shard &amp; Segment</a></h1>
  <div class="post-meta">
      
    <span class="post-date">
      2020-11-04
    </span>
    
    
    <span class="post-author">::
      x1ah
    </span>
    
  </div>

  
  <span class="post-tags">
    
    #<a href="/tags/elasticsearch/">Elasticsearch</a>&nbsp;
    
  </span>
  

  

  <div class="post-content">
    <p>References from <a href="https://stackoverflow.com/a/15429578">https://stackoverflow.com/a/15429578</a></p>
<p>To explain:</p>
<h2 id="index">Index</h2>
<p>An &ldquo;index&rdquo; in Elasticsearch is a bit like a database in a relational DB. It&rsquo;s where you store/index your data. But actually, that&rsquo;s just what your application sees. Internally, an index is a logical namespace that points to one or more shards.</p>
<p>Also, &ldquo;to index&rdquo; means to &ldquo;put&rdquo; your data into Elasticsearch. Your data is both stored (for retrieval) and &ldquo;indexed&rdquo; for search.</p>
<h2 id="inverted-index">Inverted Index</h2>
<p>An &ldquo;inverted index&rdquo; is the data structure that Lucene uses to make data searchable. It processes the data, pulls out unique terms or tokens, then records which documents contain those tokens. See <a href="http://en.wikipedia.org/wiki/Inverted_index">http://en.wikipedia.org/wiki/Inverted_index</a> for more.</p>
<h2 id="shard">Shard</h2>
<p>A &ldquo;shard&rdquo; is an instance of Lucene. It is a fully functional search engine in its own right. An &ldquo;index&rdquo; could consist of a single shard, but generally consists of several shards, to allow the index to grow and to be split over several machines.</p>
<p>A &ldquo;primary shard&rdquo; is the main home for a document. A &ldquo;replica shard&rdquo; is a copy of the primary shard that provides (1) failover in case the primary dies and (2) increased read throughput</p>
<h2 id="segment">Segment</h2>
<p>Each shard contains multiple &ldquo;segments&rdquo;, where a segment is an inverted index. A search in a shard will search each segment in turn, then combine their results into the final results for that shard.</p>
<p>While you are indexing documents, Elasticsearch collects them in memory (and in the transaction log, for safety) then every second or so, writes a new small segment to disk, and &ldquo;refreshes&rdquo; the search.</p>
<p>This makes the data in the new segment visible to search (ie they are &ldquo;searchable&rdquo;), but the segment has not been fsync&rsquo;ed to disk, so is still at risk of data loss.</p>
<p>Every so often, Elasticsearch will &ldquo;flush&rdquo;, which means fsync&rsquo;ing the segments, (they are now &ldquo;committed&rdquo;) and clearing out the transaction log, which is no longer needed because we know that the new data has been written to disk.</p>
<p>The more segments there are, the longer each search takes. So Elasticsearch will merge a number of segments of a similar size (&ldquo;tier&rdquo;) into a single bigger segment, through a background merge process. Once the new bigger segment is written, the old segments are dropped. This process is repeated on the bigger segments when there are too many of the same size.</p>
<p>Segments are immutable. When a document is updated, it actually just marks the old document as deleted, and indexes a new document. The merge process also expunges these old deleted documents.</p>
<p>References from <a href="https://stackoverflow.com/a/15429578">https://stackoverflow.com/a/15429578</a></p>

  </div>
  
  <div class="pagination">
    <div class="pagination__title">
      <span
        class="pagination__title-h">其他文章</span>
      <hr />
    </div>
    <div class="pagination__buttons">
      
      
      <span class="button next">
        <a href="/posts/tcp/">
          <span class="button__text">TCP 札记</span>
          <span class="button__icon">→</span>
        </a>
      </span>
      
    </div>
  </div>
  

  <script src="https://utteranc.es/client.js"
        repo="x1ah/x1ah.github.io"
        issue-term="pathname"
        label="Comment"
        theme="photon-dark"
        crossorigin="anonymous"
        async>
</script>
</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2020 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>





  
</div>

</body>
</html>
